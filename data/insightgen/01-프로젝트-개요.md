# 프로젝트 개요

## 목적과 핵심 기능
- 본 프로젝트는 코드 구조 분석 및 검색, 코드 기반 질의응답을 통해 개발자와 운영자가 코드베이스를 효율적으로 이해하고 활용할 수 있도록 돕는 것을 목표로 합니다.
- 해결하려는 문제: 대규모 코드베이스의 구조적 이해 부족, 검색 효율성 저하, 코드 관련 질의응답의 비효율성.
- 핵심 기능:
  - **코드 구조 분석(StructSynth)**: 코드의 구조적 요소를 분석하고 데이터베이스에 저장.
  - **코드 인사이트/검색**: 코드 심볼 및 메타데이터 검색.
  - **코드 채팅(CodeChat)**: 코드 관련 질의응답을 지원.

## 시스템 구성
- **백엔드**: FastAPI (포트: 8000)
- **UI**: Streamlit (포트: 8501)
- **주요 디렉토리**:
  - `agents/`: StructSynth, CodeChat 관련 로직.
  - `api/`: API 엔드포인트 정의.
  - `ui/`: 사용자 인터페이스 구성.
  - `common/`: 공통 유틸리티 및 설정.
  - `tools/`: 데이터 처리 및 분석 도구.
- **데이터/아티팩트**:
  - `data/structsynth_code.db`: 코드 구조 데이터베이스.
  - `artifacts/faiss.index`: 벡터 인덱스 파일.
  - `artifacts/backend.log`: 백엔드 로그 파일.
- **의존 사항**:
  - Azure OpenAI 서비스 (환경 변수: `AZURE_OPENAI_API_KEY`, `AZURE_OPENAI_ENDPOINT`, `AZURE_OPENAI_API_VERSION`, `AZURE_OPENAI_DEPLOYMENT_NAME`, `AZURE_OPENAI_EMBEDDING_DEPLOYMENT`).

## 실행 방법
1. **Docker Compose 실행**:
   ```bash
   docker compose up -d
   ```
   또는 `run_all.sh` 스크립트 실행.
2. **헬스체크**:
   - 백엔드: [http://localhost:8000/health](http://localhost:8000/health)
   - UI: [http://localhost:8501](http://localhost:8501)

## 데이터베이스/벡터 스토어 상태 요약
| 항목                | 값          |
|---------------------|-------------|
| 총 파일 수          | 2           |
| 총 심볼 수          | 156         |
| 총 청크 수          | 34          |
| 총 임베딩 수        | 34          |
| 언어                | Python (2)  |
| 심볼 유형           | 클래스: 2, 함수: 32, 외부 호출: 122 |
| 벡터 수             | 64          |
| 벡터 차원           | 3072        |
| 문서 ID 개수        | 64          |
| 분석 상태           | No analysis performed |

## 주요 컴포넌트 설명
- **Agents**:
  - **StructSynth**: 코드 구조를 분석하여 데이터베이스에 저장. 입력: 코드 디렉토리, 출력: 구조적 데이터.
  - **CodeChat**: 코드 관련 질의응답 수행. 입력: 사용자 질문, 출력: 답변.
- **API**:
  - 주요 엔드포인트:
    - `/`: 기본 엔드포인트.
    - `/health`: 서비스 상태 확인.
    - `/api/agents`: StructSynth 관련 작업.
    - `/api/chat`: CodeChat 질의응답.
  - 사용 요약: RESTful API 호출로 데이터 분석 및 질의응답 수행.
- **UI**:
  - **탭 구성**:
    - Code Analysis: 코드 분석 결과 확인.
    - Code Chat: 코드 관련 질의응답.
    - Docs: 문서 및 가이드.
    - Status: 시스템 상태 확인.
  - **사용 흐름**: 코드 분석 → 결과 확인 → 질의응답.

## 기본 사용 시나리오
1. **코드 디렉토리 분석**: StructSynth를 통해 코드 구조 분석.
2. **데이터베이스 및 벡터 구축**: 분석 결과를 DB 및 벡터 스토어에 저장.
3. **UI 접속**: [http://localhost:8501](http://localhost:8501)에서 UI 실행.
4. **Code Analysis 확인**: 분석된 코드 구조 및 메타데이터 확인.
5. **Code Chat 사용**: 코드 관련 질문 입력 및 답변 확인.
6. **결과 활용**: 검색 및 질의응답 결과를 기반으로 작업 수행.

## 문제 해결 가이드(요약)
- **API 연결 실패**:
  - 원인: FastAPI 서버 미실행.
  - 조치: `docker compose up -d`로 서버 실행.
- **임베딩/벡터 미로딩**:
  - 원인: `faiss.index` 파일 누락.
  - 조치: `tools/` 스크립트로 벡터 생성.
- **환경변수 미설정**:
  - 원인: Azure OpenAI 관련 환경변수 누락.
  - 조치: `.env` 파일에 환경변수 추가 후 재실행.

## 다음 액션
1. **코드 분석 실행**: `docker compose up -d`로 시스템 실행 후 StructSynth로 코드 디렉토리 분석.
2. **CodeChat 테스트**: UI에서 코드 관련 질문 입력 및 응답 확인.
3. **
4. **시스템 상태 점검**: `/health` 엔드포인트를 호출하여 서비스 상태 확인.  
5. **문서 참조**: UI의 Docs 탭에서 사용 가이드 및 API 문서 확인.  
6. **결과 데이터 활용**: 분석된 데이터 및 질의응답 결과를 프로젝트 개선 또는 문서화에 반영.  

## 추가 고려사항
- **확장성**: StructSynth와 CodeChat의 기능을 확장하여 더 복잡한 코드베이스를 처리하거나 추가 언어를 지원하도록 개선 가능.  
- **보안**: API 호출 시 인증 및 권한 관리를 추가하여 데이터 보호 강화.  
- **성능 최적화**: 대규모 코드베이스 분석 시 병렬 처리 및 캐싱 활용 검토.